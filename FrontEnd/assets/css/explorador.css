/* -------- Reset mínimo -------- */
* { box-sizing: border-box; }
html, body { height: 100%; }
body, h1, h2, h3, h4, h5, h6, p, ul { margin: 0; }
img { max-width: 100%; display: block; }
button { font: inherit; }

/* =========================================================
   TOKENS
   ========================================================= */
:root{
  /* Tipografía */
  --font-sans: ui-sans-serif, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;

  /* Radios y sombras */
  --radius-sm: 10px;
  --radius-md: 12px;
  --radius-lg: 14px;
  --shadow: 0 10px 30px rgba(0,0,0,.25);

  /* Transiciones */
  --t: 160ms ease;

  /* Tema (Herbario Claro) */
  --bg: #fbfcfd;
  --bg-2: #ffffff;
  --bg-3: #f3f6f9;
  --line: #c9d6e2;
  --line-soft: #b8c8d7;
  --text: #0f2736;
  --text-2: #244356;
  --muted: #2d6c9e;
  --accent: #1b88e5;
  --accent-2: #1670be;
  --danger: #e94b4b;
  --ok: #0a9f70;
}

/* Tema (Jungla Oscuro) */
:root[data-theme="dark"]{
  --bg: #08131b;
  --bg-2: #0b1620;
  --bg-3: #0f2434;
  --line: #1f3a53;
  --line-soft: #143046;
  --text: #e5f4ff;
  --text-2: #cfe8ff;
  --muted: #9bd1ff;
  --accent: #4cc3ff;
  --accent-2: #2aa7e6;
  --danger: #ff5c5c;
  --ok: #0ad383;
}

/* =========================================================
   BASE
   ========================================================= */
html { scroll-behavior: smooth; }
body{
  font-family: var(--font-sans);
  background: var(--bg);
  color: var(--text);
  line-height: 1.5;
  transition: background var(--t), color var(--t);
}
a{ color: var(--muted); text-decoration: none; }
a:hover{ color: var(--accent); }

/* Contenedor */
.container{ width: min(1080px, 94vw); margin: 20px auto; }

/* Header */
header.container{ display: grid; gap: 8px; }
.back{ display:inline-block; color: var(--muted); margin-bottom: 8px; }
.back:hover{ color: var(--accent); }
h1{ font-size: clamp(22px, 2.4vw, 30px); font-weight: 800; }
.subtitle{ color: var(--text-2); opacity: .85; }

/* Botones base */
.btn{
  background: var(--bg-3);
  color: var(--text-2);
  border: 1px solid var(--line);
  padding: 10px 14px;
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: background var(--t), border-color var(--t), transform var(--t), color var(--t);
}
.btn:hover{ background: var(--line-soft); }
.btn:active{ transform: translateY(1px); }
.btn-ghost{
  background: transparent;
  border-color: var(--line);
}
.btn-small{
  display:inline-block;
  margin-top:6px;
  padding:6px 10px;
  border-radius: var(--radius-sm);
  border:1px solid var(--line);
  background: var(--bg-3);
  color: var(--text-2);
}
.btn-small:hover{ background: var(--line-soft); }

/* Tabs */
.tabs{
  display: flex; flex-wrap: wrap;
  gap: 8px; margin: 12px 0 14px;
}
.tab-btn{
  background: var(--bg-3);
  color: var(--text-2);
  border: 1px solid var(--line);
  padding: 8px 12px;
  border-radius: 999px;
  cursor: pointer;
  font-weight: 600;
  transition: background var(--t), color var(--t), border-color var(--t);
}
.tab-btn.small{ padding: 6px 10px; font-size: 13px; }
.tab-btn:hover{ background: var(--line-soft); }
.tab-btn.active{ background: var(--accent-2); border-color: var(--accent-2); color: #fff; }
.tab-panel{ display: none; }
.tab-panel.show{ display: block; }

/* Buscador (explorador.html) */
.searchbar{ display:flex; gap:8px; align-items:center; margin: 10px 0 14px; }
.searchbar input{
  flex:1; background: var(--bg-3); border:1px solid var(--line); color: var(--text);
  padding: 12px 14px; border-radius: var(--radius-md); outline: none; transition: border-color var(--t), background var(--t);
}
.searchbar input::placeholder{ color:#8aa6bb; }
.searchbar input:focus{ border-color: var(--accent); background: color-mix(in srgb, var(--bg-3) 85%, var(--accent) 15%); }

/* Mapa */
.map{
  width: 100%;
  height: 380px;
  border-radius: var(--radius-lg);
  border: 1px solid var(--line);
  overflow: hidden;
  box-shadow: var(--shadow);
  background: #071017;
}

/* Info / estados */
.status{ margin-top: 8px; font-size: 14px; color: var(--text-2); opacity: .85; }

/* Badges / chips */
.badge{
  display:inline-block; padding:4px 8px; border-radius:999px;
  border:1px solid var(--line); background: var(--bg-3);
  margin: 2px 6px 0 0; font-size:12px; color: var(--text-2);
}
.badge a { color: var(--muted) }
.badge a:hover { text-decoration:underline }

/* Grid tarjetas */
.grid{ display:grid; grid-template-columns: repeat(4, 1fr); gap: 14px; }
@media (max-width: 1024px){ .grid{ grid-template-columns: repeat(3, 1fr); } }
@media (max-width: 700px){ .grid{ grid-template-columns: repeat(2, 1fr); } }
@media (max-width: 420px){ .grid{ grid-template-columns: 1fr; } }

.card{
  background: var(--bg-2);
  border: 1px solid var(--line);
  border-radius: var(--radius-lg);
  overflow: hidden;
  box-shadow: var(--shadow);
  color: inherit;
  cursor: pointer;
  transition: transform var(--t), box-shadow var(--t), border-color var(--t);
}
.card:hover, .card:focus{ 
  transform: translateY(-2px); 
  box-shadow: 0 12px 34px rgba(0,0,0,.18); 
  border-color: var(--line-soft); 
  outline: none;
}
.card img{
  width: 100%; height: 160px; object-fit: cover; background:#0a0f14;
  transition: filter var(--t), transform var(--t);
}
.card:hover img{ filter: saturate(1.05); transform: scale(1.01); }
.card .padded{ padding: 10px; }
.card .common{ font-weight: 800; }
.card .sci{ color: var(--muted); font-style: italic; font-size: 13px; }

/* Skeleton (para imgs mientras cargan) */
img[data-skeleton]{
  background: linear-gradient(90deg, var(--bg-2) 0%, var(--bg-3) 50%, var(--bg-2) 100%);
  background-size: 200% 100%;
  animation: shimmer 1.3s infinite linear;
}
@keyframes shimmer{ 0%{background-position:200% 0} 100%{background-position:-200% 0} }

/* Listas de taxonomía (detail.html) */
.taxonomy{
  list-style: none; padding: 0; margin: 0; display: grid; gap: 6px;
}
.taxonomy li{
  background: var(--bg-3); border: 1px solid var(--line);
  border-radius: var(--radius-sm); padding: 8px 10px;
}
.taxonomy strong{ color: var(--text-2); }

/* “Acerca de” (detail.html) */
#about h4 { margin:14px 0 6px; font-weight:800; color: var(--text-2) }
#about p { line-height:1.75; margin:8px 0 }
#about details{
  background: var(--bg-3); border:1px solid var(--line);
  border-radius: var(--radius-sm); padding:10px 12px; margin-top:8px;
}
#about details > summary{ list-style:none; font-weight:700; color: var(--muted); cursor:pointer; }
#about details[open] > summary{ margin-bottom: 8px; }

/* Ficha técnica (detail.html) */
.factbox{
  display:grid; grid-template-columns: 1fr; gap:8px;
  padding:12px; border:1px solid var(--line); border-radius: var(--radius-md);
  background: var(--bg-3); margin: 10px 0;
}
.fact{ display:grid; grid-template-columns: 160px 1fr; gap:8px }
.fact-k{ font-weight:800; color: var(--text-2) }
.fact-v{ opacity:.95 }

/* Artículo completo (HTML sanitizado) */
.wiki-article { margin-top:8px; line-height:1.8; }
.wiki-article h2, .wiki-article h3, .wiki-article h4 { margin:16px 0 8px; color: var(--text-2) }
.wiki-article table { margin:10px 0; width: 100%; border-collapse: collapse; }
.wiki-article th, .wiki-article td { border: 1px solid var(--line); padding: 6px 8px; vertical-align: top; }
.wiki-article a { color: var(--muted); }
.wiki-article a:hover { text-decoration:underline }
.wiki-article img { max-width: 100%; height: auto; border-radius: var(--radius-sm); }

/* Lightbox (zoom) */
.lb { position: fixed; inset: 0; display: none; place-items: center; background: rgba(0,0,0,.78); z-index: 9999; }
.lb[aria-hidden="false"] { display: grid; }
.lb__backdrop { position:absolute; inset:0; cursor: pointer; }
.lb__img {
  max-width: 92vw; max-height: 82vh; object-fit: contain;
  box-shadow: var(--shadow); border-radius: var(--radius-md);
  border: 1px solid var(--line); background: var(--bg-2);
}
.lb__cap { margin-top: 8px; color: var(--text-2); text-align:center; max-width: 92vw; }
.lb__btn {
  position:absolute; top: 50%; transform: translateY(-50%);
  width:44px; height:44px; border-radius:50%;
  background: var(--bg-3); border:1px solid var(--line); color: var(--text);
  display:grid; place-items:center; font-size:28px; cursor:pointer; user-select:none; box-shadow: var(--shadow);
}
.lb__btn:hover { background: var(--line-soft); }
.lb__close { top: 24px; right: 24px; transform:none; font-size:30px; }
.lb__prev { left: 24px; }
.lb__next { right: 24px; }
@media (max-width: 640px){
  .lb__btn{ width:38px; height:38px; font-size:24px }
  .lb__close{ top:16px; right:16px }
}

/* Leaflet ajustes */
.leaflet-container{ background: #071017; font: inherit; color: inherit; }
.leaflet-control-zoom a{ background: var(--bg-3); border: 1px solid var(--line); color: var(--text); }
.leaflet-control-zoom a:hover{ background: var(--line-soft); }

/* Popups personalizados */
.leaflet-popup-content { margin: 10px 12px; }
.popupbox{ display:flex; gap:10px; align-items:flex-start; }
.popupbox__img{ width:120px; height:90px; object-fit:cover; border-radius: var(--radius-sm); border:1px solid var(--line); background:#0a0f14; }
.popupbox__body{ display:grid; gap:4px }
.popupbox__title{ font-weight:800 }
.popupbox__sci{ font-style:italic; color: var(--muted); font-size: 13px }
.popupbox__meta{ font-size: 12px; opacity:.85 }

/* Utilidades */
.mt-8{ margin-top: 8px }
.mt-12{ margin-top: 12px }
.mt-16{ margin-top: 16px }