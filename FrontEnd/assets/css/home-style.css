/* --- VARIABLES GLOBALES Y TEMA CLARO (DEFAULT) --- */
:root, html[data-theme="claro"] { /* Aplica a :root y específicamente a claro */
  /* Paleta Claro */
  --bg: #f4f7f6;         /* Fondo principal muy claro */
  --bg2: #ffffff;        /* Fondo secundario (cards, sidebar) */
  --text: #1a2e25;       /* Texto principal oscuro */
  --muted: #5a7066;      /* Texto secundario/apagado */
  --border: #d8e0db;     /* Bordes sutiles */
  --primary: #16a34a;    /* Verde primario */
  --primary-strong: #15803d;
  --primary-light: #22c55e;
  --accent: #0ea5e9;     /* Azul cielo como acento */
  --shadow-color: rgba(40, 60, 50, 0.15); /* Sombra suave */
  --card-shadow: 0 4px 10px -2px var(--shadow-color);
  --input-bg: #e9eeeb;   /* Fondo inputs */

  /* Radios y Transiciones */
  --radius: 12px;
  --radius-sm: 8px;
  --transition: 0.2s ease-out;
}

/* --- TEMA OSCURO --- */
html[data-theme="oscuro"] {
  --bg: #0a110e;
  --bg2: #0f1a15;
  --text: #e1eee8;
  --muted: #8ca89a;
  --border: #253a31;
  --primary: #22c55e; /* Mantenemos verde brillante */
  --primary-strong: #16a34a;
  --primary-light: #4ade80;
  --accent: #38bdf8; /* Azul más brillante */
  --shadow-color: rgba(0, 0, 0, 0.3);
  --input-bg: #1a2e25;
}

/* --- TEMA ECOLÓGICO --- */
html[data-theme="ecologico"] {
  --bg: #f0fdf4;         /* Verde muy pálido */
  --bg2: #ffffff;
  --text: #14532d;       /* Verde oscuro para texto */
  --muted: #15803d;
  --border: #a7f3d0;     /* Borde verde claro */
  --primary: #16a34a;
  --primary-strong: #14532d;
  --primary-light: #22c55e;
  --accent: #fb923c;     /* Naranja como acento */
  --shadow-color: rgba(22, 163, 74, 0.15);
  --input-bg: #dcfce7;
}

/* --- RESET Y BASE --- */
* { box-sizing: border-box; }
html { scroll-behavior: smooth; }
html, body { height: 100%; }
body {
  margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  color: var(--text); background: var(--bg);
  display: flex; transition: background var(--transition), color var(--transition);
  font-size: 15px; line-height: 1.6;
}
a { color: var(--accent); text-decoration: none; transition: color var(--transition); }
a:hover { color: var(--primary); text-decoration: underline; }

/* --- LAYOUT (Sidebar + Main) --- */
.sidebar { /* Menú Lateral */
  width: 250px; min-width: 230px; padding: 16px; border-right: 1px solid var(--border);
  background: var(--bg2); box-shadow: 2px 0 10px -2px var(--shadow-color);
  display: flex; flex-direction: column; gap: 14px; transition: transform 0.25s ease, background var(--transition), border-color var(--transition); z-index: 10;
  height: 100vh; position: sticky; top: 0;
}
.sidebar.hidden { transform: translateX(-100%); }
.brand { display: flex; align-items: center; gap: 10px; padding: 6px 8px; margin-bottom: 10px; }
.brand img.logo { width: 38px; height: 38px; border-radius: 8px; object-fit: contain; }
.brand-name { font-weight: 700; font-size: 1.1em; letter-spacing: .3px; color: var(--text); }
.menu { display: flex; flex-direction: column; gap: 5px; flex-grow: 1; }
.menu-item { display: block; padding: 10px 14px; border-radius: var(--radius-sm); color: var(--muted); text-decoration: none; border: 1px solid transparent; font-size: 0.9em; transition: background var(--transition), border-color var(--transition), color var(--transition); font-weight: 500; }
.menu-item:hover { background: var(--input-bg); border-color: transparent; color: var(--text); }
.menu-item.active { background: color-mix(in srgb, var(--primary) 10%, transparent); border-color: transparent; color: var(--primary); font-weight: 600; }
.menu-sep { height: 1px; background: var(--border); margin: 8px 0; }
.sidebar-foot { margin-top: auto; display: flex; flex-direction: column; gap: 8px; padding-top: 10px; border-top: 1px solid var(--border); }

.main { flex: 1; display: flex; flex-direction: column; min-width: 0; max-height: 100vh; overflow-y: auto; background: var(--bg); }
.topbar { /* Barra Superior */
  display: flex; justify-content: space-between; align-items: center; padding: 12px 24px; border-bottom: 1px solid var(--border);
  background: var(--bg2); box-shadow: 0 2px 8px -2px var(--shadow-color);
  position: sticky; top: 0; z-index: 5;
}
.topbar .left { display: flex; align-items: center; gap: 14px; }
.icon-btn { font-size: 20px; line-height: 1; background: transparent; border: 1px solid var(--border); border-radius: var(--radius-sm); color: var(--muted); padding: 7px 9px; cursor: pointer; display: none; }
.icon-btn:hover { background: var(--input-bg); color: var(--text); }
.hello h1 { margin: 0; font-size: clamp(17px, 2.2vw, 20px); font-weight: 600; color: var(--text); }
.muted { margin: 1px 0 0; color: var(--muted); font-size: 13px; }

/* --- BOTONES --- */
.btn { padding: 9px 14px; border-radius: var(--radius-sm); border: 0; cursor: pointer; font-weight: 600; color: #fff; text-decoration: none; display: inline-block; text-align: center; transition: background 0.15s ease, transform 0.1s ease, box-shadow 0.15s ease; font-size: 14px; line-height: 1.4; }
.btn:active { transform: translateY(1px); }
.btn.primary { background: linear-gradient(180deg, var(--primary), var(--primary-strong)); box-shadow: 0 2px 8px -1px color-mix(in srgb, var(--primary) 40%, transparent); }
.btn.primary:hover { background: linear-gradient(180deg, var(--primary-light), var(--primary)); box-shadow: 0 4px 12px -2px color-mix(in srgb, var(--primary) 50%, transparent); }
.btn.ghost { background: transparent; border: 1px solid var(--border); color: var(--muted); }
.btn.ghost:hover { background: var(--input-bg); border-color: color-mix(in srgb, var(--border) 70%, var(--muted)); color: var(--text); }
.btn-sm { padding: 5px 10px; font-size: 12px; border-radius: var(--radius-sm); }
.btn.switch { font-size: 13px; padding: 8px 12px; }
.btn.switch.insectos { background: linear-gradient(180deg, var(--secondary), var(--secondary-strong)); }
body[data-page-theme="insectos"] .btn.switch { background: linear-gradient(180deg, #22c55e, #15803d); }
.btn.switch:hover { filter: brightness(1.1); }
.btn.secondary { background: var(--input-bg); color: var(--muted); border: 1px solid var(--border); }
.btn.secondary:hover { background: var(--border); color: var(--text); }

/* --- Área de Contenido General --- */
.content-area { padding: 24px; }
.content-area h2 { margin: 0 0 20px; font-size: 1.6em; font-weight: 600; color: var(--text); border-bottom: 1px solid var(--border); padding-bottom: 10px; }
.content-area h3 { margin: 25px 0 15px; font-size: 1.3em; font-weight: 600; color: var(--muted); }
.form-card { background: var(--bg2); border: 1px solid var(--border); border-radius: var(--radius); padding: 20px; box-shadow: var(--card-shadow); margin-bottom: 20px; }
.input-group { margin-bottom: 18px; }
.input-group label { display: block; font-size: 0.9em; color: var(--muted); margin-bottom: 6px; font-weight: 500; }
.input-group input[type="text"], .input-group input[type="email"], .input-group input[type="password"], .input-group input[type="number"], .input-group textarea, .input-group select { width: 100%; padding: 10px 12px; border-radius: var(--radius-sm); border: 1px solid var(--border); background: var(--input-bg); color: var(--text); font-size: 0.95em; outline: none; transition: border-color var(--transition), background var(--transition); }
.input-group input:focus, .input-group textarea:focus, .input-group select:focus { border-color: var(--primary); background: var(--bg2); }
.input-group textarea { min-height: 80px; resize: vertical; }
.input-group input[disabled] { background-color: color-mix(in srgb, var(--input-bg) 70%, var(--muted)); cursor: not-allowed; opacity: 0.7; }
.input-group input[type="checkbox"] { width: auto; margin-right: 8px; vertical-align: middle; accent-color: var(--primary); } /* Checkbox color */
.input-group input[type="checkbox"] + label { display: inline; font-weight: normal; font-size: 0.95em; }

.message-area { min-height: 1.5em; margin-bottom: 15px; font-weight: 500; font-size: 0.9em; transition: color 0.3s; }
.message-area.error { color: var(--danger, #e53e3e); }
.message-area.success { color: var(--ok, #38a169); }

/* --- BUSCADOR (Plantas/Insectos) --- */
.search-wrap { padding: 18px 24px 8px; }
.searchbar { display: grid; grid-template-columns: 1fr auto auto; gap: 10px; align-items: center; background: var(--bg2); border: 1px solid var(--border); padding: 10px; border-radius: var(--radius); box-shadow: var(--card-shadow); }
.searchbar input { width: 100%; padding: 10px 14px; border-radius: var(--radius-sm); border: 1px solid var(--border); background: var(--input-bg); color: var(--text); font-size: 14px; outline: none; transition: border-color var(--transition), background var(--transition); }
.searchbar input:focus { border-color: var(--primary); background: var(--bg2); }
.search-state { margin-top: 8px; color: var(--muted); font-size: 13px; min-height: 1.2em; }

/* --- RESUMEN (STATS) --- */
.summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; padding: 8px 24px; }
.stat { background: var(--bg2); border: 1px solid var(--border); border-radius: var(--radius); padding: 12px 14px; box-shadow: var(--card-shadow); text-align: center; }
.stat-num { font-size: 20px; font-weight: 700; color: var(--primary); display: block; margin-bottom: 2px;}
.stat-label { color: var(--muted); font-size: 12px; display: block; }

/* --- MAPA --- */
.map-panel { padding: 10px 24px 0; transition: max-height 0.3s ease-out, opacity 0.3s ease-out, margin-bottom 0.3s ease-out, padding 0.3s ease-out; max-height: 400px; opacity: 1; margin-bottom: 18px; overflow: hidden; }
.map-panel.hidden { max-height: 0; opacity: 0; margin-bottom: 0; padding-top: 0; padding-bottom: 0; }
.map { height: 350px; width: 100%; border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; background: var(--input-bg); }

/* --- GRID TARJETAS (Plantas/Insectos/Similares) --- */
.content { padding: 0 24px 24px; display: grid; gap: 18px; }
.cards { display: grid; gap: 14px; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); } /* Tamaño base */

/* Estilo Tarjeta Overlay */
.card { position: relative; border-radius: var(--radius-sm); overflow: hidden; border: 1px solid var(--border); background: var(--bg2); aspect-ratio: 3 / 4; cursor: pointer; transition: transform 0.15s ease, box-shadow 0.15s ease, border-color 0.15s ease; box-shadow: var(--card-shadow); }
.card:hover { transform: translateY(-3px) scale(1.02); box-shadow: 0 8px 15px -3px var(--shadow-color); border-color: color-mix(in srgb, var(--primary) 50%, transparent); }
.card img { width: 100%; height: 100%; object-fit: cover; display: block; background: var(--input-bg); }
.card .species-info { position: absolute; bottom: 0; left: 0; right: 0; padding: 20px 10px 8px 10px; color: #fff; background: linear-gradient(to top, rgba(0, 0, 0, 0.9) 20%, rgba(0, 0, 0, 0.6) 60%, transparent 100%); }
.card .species-info h4 { font-weight: 600; font-size: 0.85em; margin: 0 0 2px; line-height: 1.25; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: #fff; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8); }
.card .species-info p { font-size: 0.7em; margin: 0; font-style: italic; color: rgba(255, 255, 255, 0.85); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8); }
.card .species-info .btn-details { display: none; }

img[data-skeleton] { background: linear-gradient(90deg, var(--input-bg) 0%, var(--border) 50%, var(--input-bg) 100%); background-size: 200% 100%; animation: shimmer 1.5s infinite linear; } @keyframes shimmer { 0% { background-position: 200% 0 } 100% { background-position: -200% 0 } }
.tag { display: inline-block; background: var(--chip); border: 1px solid color-mix(in srgb, var(--primary) 30%, transparent); color: var(--muted); border-radius: var(--radius-sm); padding: 3px 7px; font-size: 11px; margin: 0 5px 5px 0; }
.skeleton.card { cursor: default; position: relative; aspect-ratio: 3 / 4; background: var(--input-bg); } .skeleton.card::after { content: ""; position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(255, 255, 255, .05), transparent); animation: sk 1.5s infinite; } .skeleton.card:hover { transform: none; box-shadow: var(--card-shadow); border-color: var(--border); } @keyframes sk { from { transform: translateX(-100%) } to { transform: translateX(100%) } }

/* --- PERFIL TOPBAR --- */
.topbar .right { display: flex; align-items: center; gap: 12px; }
.profile-section { display: flex; align-items: center; gap: 8px; cursor: pointer; border: 1px solid transparent; padding: 4px 6px; border-radius: var(--radius-sm); transition: background var(--transition), border-color var(--transition); }
.profile-section:hover { background: var(--input-bg); border-color: var(--border); }
.profile-name { font-size: 0.85em; font-weight: 500; color: var(--muted); white-space: nowrap; }
.profile-avatar { width: 30px; height: 30px; border-radius: 50%; object-fit: cover; border: 2px solid var(--border); }

/* --- PÁGINA DE PERFIL (`perfil.html`) --- */
#profile-form .input-group, #theme-options { margin-bottom: 20px; } /* Espaciado uniforme */
#current-photo { display: block; width: 120px; height: 120px; margin: 0 auto 15px; border: 4px solid var(--border); padding: 4px; background: var(--bg2); border-radius: 50%; object-fit: cover; box-shadow: var(--card-shadow);}
input[type="file"] { font-size: 0.85em; color: var(--muted); margin-top: 5px; display: block; text-align: center; } /* Centrar input file */
#theme-options .theme-btn { display: block; width: 100%; text-align: left; margin-bottom: 10px; border: 2px solid var(--border); background: var(--input-bg); color: var(--text); transition: border-color var(--transition), box-shadow .15s ease, background var(--transition); font-weight: 500; padding: 12px 16px; border-radius: var(--radius-sm);}
#theme-options .theme-btn.active { border-color: var(--primary); font-weight: bold; box-shadow: 0 0 0 2px color-mix(in srgb, var(--primary) 50%, transparent); }
/* Colores botones tema */
#theme-options .theme-btn[data-theme="claro"] { background-color: #f4f7f6; color: #1a2e25; border-color: #d8e0db; }
#theme-options .theme-btn[data-theme="claro"]:not(.active):hover { background-color: #e9eeeb; }
#theme-options .theme-btn[data-theme="oscuro"] { background-color: #0f1a15; color: #e1eee8; border-color: #253a31; }
#theme-options .theme-btn[data-theme="oscuro"]:not(.active):hover { background-color: #1a2e25; }
#theme-options .theme-btn[data-theme="ecologico"] { background-color: #dcfce7; color: #14532d; border-color: #a7f3d0; }
#theme-options .theme-btn[data-theme="ecologico"]:not(.active):hover { background-color: #bbf7d0; }

/* --- OTROS (Detail, Lightbox, Responsive, Footer, Leaflet) --- */
.detail-tabs { margin-bottom: 20px; padding: 0 24px; border-bottom: 1px solid var(--border);} .detail-tabs .tab-btn { border-radius: 8px 8px 0 0; border-bottom: 0; margin-bottom: -1px; background: transparent; border-color: transparent; padding: 8px 12px; font-size: 13px;} .detail-tabs .tab-btn:hover { background: var(--input-bg); } .detail-tabs .tab-btn.active { background: var(--bg); border-color: var(--border); border-bottom-color: var(--bg); color: var(--primary);} .tab-panel { animation: fadeIn 0.3s ease-out; display: none; } .tab-panel.show { display: block; } @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } } .tab-panel h3 { margin: 1.6em 0 0.9em; font-weight: 600; font-size: 1.1em; color: var(--muted); border-bottom: 1px solid var(--border); padding-bottom: 5px;} .tab-panel h3:first-child { margin-top: 0; } #tab-overview .cards { margin-top: 12px; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px;} #tab-overview .cards img { height: 100px; } .wiki-article { margin-top: 15px; line-height: 1.7; font-size: 0.9em; color: var(--text); } .wiki-article h2, .wiki-article h3, .wiki-article h4 { margin: 1.1em 0 0.5em; color: var(--muted); font-weight: 600; } .wiki-article a { color: var(--primary); text-decoration: none; } .wiki-article a:hover { text-decoration: underline; } .wiki-article img { max-width: 100%; height: auto; border-radius: 6px; margin: 10px 0; border: 1px solid var(--border); } .wiki-article table { margin: 12px 0; width: auto; max-width: 100%; border-collapse: collapse; font-size: 0.85em; } .wiki-article th, .wiki-article td { border: 1px solid var(--border); padding: 6px 8px; text-align: left; } .wiki-article th { background: var(--card); font-weight: 600; } .taxonomy { list-style: none; padding: 0; } .taxonomy li { margin-bottom: 5px; font-size: 0.9em; } .taxonomy strong { color: var(--muted); margin-right: 6px; }
.modal { position: fixed; inset: 0; display: none; place-items: center; z-index: 100; } .modal[aria-hidden="false"] { display: grid; } .modal-backdrop { position: absolute; inset: 0; background: rgba(0, 0, 0, .8); backdrop-filter: blur(4px); cursor: pointer; } .modal-card { position: relative; width: min(800px, 90vw); max-height: 90vh; background: var(--bg2); border: 1px solid var(--border); border-radius: var(--radius); padding: 20px; color: var(--text); box-shadow: var(--shadow); overflow-y: auto; } .modal-x { position: absolute; top: 10px; right: 10px; border: 0; background: transparent; color: #fff; font-size: 28px; cursor: pointer; line-height: 1; padding: 5px; } .lb__btn { position:absolute; top: 50%; transform: translateY(-50%); width:44px; height:44px; border-radius:50%; background: rgba(255,255,255,0.1); border:1px solid var(--border); color: var(--text); display:grid; place-items:center; font-size:28px; cursor:pointer; user-select:none; box-shadow: var(--shadow); z-index: 1; } .lb__btn:hover { background: rgba(255,255,255,0.2); } .lb__prev { left: 15px; } .lb__next { right: 15px; } #lb-img { display: block; max-width: 100%; max-height: 80vh; margin: auto; border-radius: var(--radius-sm); } #lb-cap { text-align: center; color: var(--muted); margin-top: 15px; font-size: 14px; }
@media (max-width: 980px){ .sidebar{position:fixed; top:0; left:0; height:100%; transform:translateX(-100%);} .sidebar.shown { transform: translateX(0); box-shadow: 10px 0 30px rgba(0,0,0,0.4); } .main{margin-left:0} .topbar .icon-btn { display: block; } }
@media (max-width: 720px){ .searchbar{grid-template-columns:1fr auto;} .searchbar #toggleMap { grid-column: 1 / 2; grid-row: 2; justify-self: start; margin-top: 8px;} .modal-card { width: 95vw; padding: 15px;} .cards{grid-template-columns:repeat(auto-fill,minmax(150px,1fr))} .card img { height: auto; aspect-ratio: 3/4; } .card .species-info { padding: 15px 8px 6px 8px; } .card .species-info h4 { font-size: 0.8em; } .card .species-info p { font-size: 0.7em; } .topbar { padding: 10px 15px; } .search-wrap, .summary, .map-panel, .content, .detail-tabs { padding-left: 15px; padding-right: 15px; } .profile-name { display: none; } .profile-avatar { width: 30px; height: 30px; } }
@media (max-width: 480px) { .summary { grid-template-columns: 1fr 1fr; gap: 8px; } .stat { padding: 10px 12px; } .stat-num { font-size: 16px; } .stat-label { font-size: 10px; } .cards{grid-template-columns: 1fr 1fr;} .card img { height: auto; aspect-ratio: 3/4; } .hello h1 { font-size: 15px; } .muted { font-size: 11px; } .btn.switch { font-size: 11px; padding: 7px 9px; } .searchbar { padding: 8px; } .searchbar input { padding: 9px 12px; font-size: 13px; } .lb__btn { width: 32px; height: 32px; font-size: 22px; } .lb__prev { left: 5px; } .lb__next { right: 5px; } .topbar .right { gap: 6px; } .profile-avatar { width: 28px; height: 28px; } }
.foot { padding: 15px 24px; text-align: center; color: var(--muted); font-size: 12px; border-top: 1px solid var(--border); margin-top: 20px;}
.leaflet-container{ background: var(--bg2); font: inherit; color: inherit; border-radius: var(--radius); } .leaflet-control-zoom a{ background: var(--card); border: 1px solid var(--border); color: var(--text); } .leaflet-control-zoom a:hover{ background: var(--input-bg); } .leaflet-popup-content-wrapper { background: var(--card); color: var(--text); border: 1px solid var(--border); border-radius: var(--radius-sm); box-shadow: var(--shadow); } .leaflet-popup-tip { background: var(--card); } .popupbox{ display:flex; gap:10px; align-items:flex-start; } .popupbox__img{ width:80px; height:60px; object-fit:cover; border-radius: var(--radius-sm); border:1px solid var(--border); background:var(--bg2); } .popupbox__body{ display:grid; gap:3px } .popupbox__title{ font-weight:600; font-size: 1em; } .popupbox__sci{ font-style:italic; color: var(--muted); font-size: 0.85em } .popupbox__meta{ font-size: 0.8em; opacity:.85 } .popupbox .btn-sm { margin-top: 6px; }